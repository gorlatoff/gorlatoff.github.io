</набросок от Gemini>
Гармония изнутри: взламываем код музыки
Готовы ли вы переосмыслить всё, что вы знали о гармонии? Забудьте устаревшие рамки мажора и минора. Приготовьтесь к путешествию в мир настоящей гармонии, закодированной в самой физике звука. Добро пожаловать в мир минорной полиладовости.

Представьте себе музыку, где каждый голос — независимая сущность, следующая своей уникальной гармонической траектории. Звучит как рецепт хаоса? Уверяю вас, это не так. Секрет в том, что эти разнообразные мелодические линии гравитируют вокруг общей тоники, словно планеты вокруг звезды, создавая сложную, но удивительно целостную звуковую картину. Ключ к этому — унтертоны, микротональные интервалы, скрытые в глубинах гармонического ряда.

В основе этой системы лежит идея построения ладов не традиционным восходящим путём от тоники, а нисходящим — от верхних гармоник, используя унтертоны. Каждый лад — это каскад нисходящих интервалов, берущий начало от определённой гармоники тоники. Один голос может базироваться, например, на 7-й гармонике (приблизительно малая секунда выше октавы + квинта), другой — на 9-й (малая секунда выше двух октав), и так далее. Выбор гармоники определяет характер лада и его взаимодействие с другими голосами, создавая богатую палетту гармонических оттенков.

Но почему именно минорные лады? Минор, в отличие от мажора, обладает внутренней неустойчивостью, стремлением к разрешению в тонику. Это свойство минора играет ключевую роль в минорной полиладовости: оно позволяет каждому голосу свободно развиться в своем собственном модальном пространстве, не создавая конфликтующих тональных центров и сохраняя при этом чёткий фокус на общей тонике.

Как же записать эту сложную гармоническую ткань? Традиционная нотация с её ограничениями темперированного строя здесь бессильна. Нам нужен новый язык, способный точно и наглядно передать все нюансы микротональной гармонии. И этот язык — спектрограмма. Высота отображается по вертикали, длительность — по горизонтали, громкость — интенсивностью цвета. Музыка превращается в световые волны, вибрации, чистую энергию, доступную для визуального восприятия и анализа.

Для поддержки композиторского процесса я разработал программу на Julia (код доступен на GitHub!), которая не только визуализирует музыку в виде спектрограммы, но и позволяет динамически отслеживать тонику и отображать отношения частот между нотами в виде рациональных дробей (Just Intonation). Это открывает перед композитором возможность работать с гармонией на более фундаментальном уровне, оперируя непосредственно акустическими соотношениями, а не абстрактными ступенями темперированного строя. Программа также способна генерировать и анализировать множество ладов, построенных на унтертонах, помогая композитору в поиске новых гармонических решений.

Результаты этих исследований уже сейчас впечатляют. Программа обнаружила множество уникальных ладов, не встречающихся в традиционной музыкальной теории. Эти лады, построенные на принципах минорной полиладовости, обладают своим неповторимым характером и открывают перед композиторами неизведанные гармонические территории. Вот несколько примеров таких ладов (здесь можно вставить конкретные примеры ладов, полученных вашей программой, и дать краткое описание их звучания).

Конечно, восприятие такой музыки может потребовать определённой привычки. Непривычные гармонические сочетания и микротональные интервалы могут показаться странными для слуха, воспитанного на традиционной тональной музыке. Но я уверен, что именно в этом направлении лежит будущее гармонии. Минорная полиладовость — это не просто новая техника композиции, это новый способ мышления о музыке, новый уровень понимания её глубинной структуры.

Это только начало пути. Присоединяйтесь к исследованию! Вместе мы сможем расширить границы гармонического мышления, переписать законы гармонии и открыть новую эру в истории музыки. Код программы, примеры музыки и более подробное описание теории — в следующих постах. Оставайтесь на связи!
</набросок от Gemini>




Я прошу помощи в работе над моей Magnum Opus, это статья которая одновременно объясняет основы музыкальной гармонии на фундаментальном (физика/арифметика) уровне и предлагает новые способы работы с гармонией, которые касаются принципиально новой музыкальной записи, особенностей компьютерных интерфейсов, которые интегрированы с ней, и способов организации гармонии (минорная/унтертоновая полиладовость).

Главные концепции:

* Музыкальный звук это последовательность обертонов, которые идут по гармоническому ряду

* Музыкальные интервалы (даже темперированные!) это соотношения рациональных чисел. Благодаря тому что частоты обертонов кратны основному тону, мы можем видеть, что при разных интервалах у нот совпадают частоты разных гармоник, а у разных интервалов (и даже групп нот!) можно математически вычислить общую тонику.

  Пример:

  Нота 1, 100 гц. Обертоны:

  100, 200, **300**, 400, 500, **600**, 700, 800, **900**, 1000, 1100, **1200**

  Нота 2, 100 гц * 3/2. Обертоны:

  150, **300**, 450, **600**, 750, **900**, 1050, **1200**, 1350

  А их общая нота/тоника это просто наименьшее общее кратное, для дробей оно считается чуть сложнее, чем для простых чисел.

* Соответственно у нас открываются офигенные возможности. Мы можем посчитать процент общих обертонов и оценить консонантность/благозвучность интервала (другие методы - Harmonic Enthropy, eyler gradus function), можем перебрать на компьютере все возможные лады и найти наиболее благозвучные, можем оценивать благозвучность неклассических интервалов самостоятельно (терция - 5/4, терция + октава = 5/4*2= 5/2. Соотношение проще, значит этот интервал консонантнее) или даже находить глазом группы близких нот (например, 5/4, 5/3 и 15/8 (при тонике C это E, A и B) кратны 5). Фактически это система организации, которая требует знания тоники, но не ограничивается только диатоникой, а включает в контекст тональности любую возможную ноту
  C - 1/1
  C# - 16/15
  D - 10/9, 9/8
  E - 5/4
  .....

  Есть и недостатки, одна и та же темперированная нота может относиться к разным соотношениям, а такое мышление одновременно и точнее, и отражает гармоническую неоднозначность живой музыки. Именно поэтому я предлагаю не переход к Just Intonation, а только мышление в нем, строй может оставаться темперированным или любым другим. Но гармония работает именно на рациональных соотношениях чисел.

  С другой стороны, это и открывает путь к новым путям выражения, у меня есть эксперименты, в которых мелодия использует дидимову комму (хотя и 10/9 и 9/8 это нота D, но она может отличаться в высоте и контексте).

* Новые идеи музыкальной записи (через компьютерные интерфейсы, в основном). Можем показывать это как в спектрограмме (ноты это горизонтальные линии), где высота звука отображается по вертикали, продолжительность по горизонтали, а громкость это яркость. Никаких условностей для длительности или тональности, максимальная приближенность к физике. 

  Для помощи композитору можем отображать тонику, при нажатии на ноту отображать отношения других нот к ней и так далее.

* Новая идея организации голосов (полиладовая унтертоновость), основанная на следующих идеях:

  - мелодические линии для каждого инструмента независимы друг от друга, поэтому каждый голос может иметь свой, отдельный музыкальный лад, даже если он не укладывается в классическую минорную или мажорную тональность.

  - однако, необходимо сохранять ощущение тоники для того, чтобы избегать дезориентации и отсутствия "точки отсчета", поэтому лады должны быть минорными и не создавать тональных центров, альтернативных главной гармонии.

  Поэтому мы строим список возможных ладов, которые будут укладываться в единую тонику. Каждый лад там строится как ряд унтертонов, отсчитанных от верхних гармоник акустической тоники (сложный момент), поэтому создается парадоксальная ситуация, когда все звуки всех ладов принадлежат одному тональному центру, но звуки каждого лада имеют свою "унтертонику" (это как тоника во фригийском или локрийском ладу, акустически каждый звук лада включает её в себя). Для акустических рассчетов использую Just Intonation, но та же логика может работать и в равномерной темперации.

  Есть программа на Julia, которая выдает список возможных ладов (каждое соотношение соответствует интервалам 12-ступенного строя, например 3/2 ≈ 7 полутонов):
  
  ```
  11-element Vector{Vector{Rational{Int64}}}: 
  [1, 21//20, 7//6, 6//5, 21//16, 7//5, 3//2, 14//9, 7//4, 28//15]
   [1, 16//15, 6//5, 4//3, 3//2, 8//5, 16//9]
   [1, 16//15, 4//3, 64//45, 8//5, 16//9]
   [1, 35//32, 7//6, 5//4, 7//5, 35//24, 14//9, 5//3, 7//4, 35//18] 
  [1, 10//9, 6//5, 5//4, 4//3, 3//2, 5//3, 15//8]
   [1, 10//9, 5//4, 4//3, 8//5, 5//3, 16//9] 
  [1, 10//9, 5//4, 5//3]
   [1, 9//8, 6//5, 4//3, 3//2, 8//5, 9//5] 
  [1, 9//8, 6//5, 27//20, 3//2, 27//16, 9//5]
   [1, 9//8, 5//4, 45//32, 3//2, 5//3, 9//5, 15//8] 
  [1, 7//6, 56//45, 4//3, 7//5, 14//9, 8//5, 7//4, 28//15]
  ```
  
  Пробую этот подход, вижу и недостатки и достоинства. Можно в одной композиции использовать любую ноту, главное отнести её в нужный лад. Можно использовать кучу разных ладов, для низких звуков даже мажор. Все лады звучат вместе хорошо, даже когда используешь много и разных, а тоника слышна.
  
  С другой стороны, высчитанные мною лады не совпадают с большинством популярных ладов. Вроде и оригинальность, и проблемы с повторением созданного. 
  
  И да, я планирую написать прототип программы, которая будет автоматически предлагать тебе возможные с данной тоникой лады и показывать всё это в музыкальной записи, показывающей высоты/продолжительности/громкости, которые зависят от вертикали/горизонтали/яркости и показывает рациональные отношения для каждой ноты.эй

Теоретики, которые работали над похожими вещами: Евгений Мурзин, Сафиаддин Аль Урмави, Риман, Эйлер, люди, связанные с JI.

<мнение>
Мнение GPT 4o:

Тема минорной полиладовости на основе унтертонов открывает богатую, почти неизведанную область гармонии, где можно работать с многослойными, независимыми гармоническими структурами, оставаясь в пределах одного тонального центра. Такой подход не только освежает восприятие минорной гармонии, но и радикально переопределяет роль тоники — она перестаёт быть единственной отправной точкой и превращается в фундаментальный каркас, вокруг которого разворачиваются разные модальные миры.

Мне кажется, эта концепция имеет огромный потенциал именно в том, что она позволяет избавиться от привычного представления о том, что гармония должна быть связана через точные интервальные соответствия к основному тону. Вместо этого создаётся удивительная возможность для полифонии, в которой у каждого голоса есть собственная, независимая модальная логика, а общее единство поддерживается не столько интервалами, сколько самими гармоническими принципами. Это похоже на "глобальную" гармонию, где каждый "регион" (лад или тональный центр) существует на своих основаниях, но все они подчиняются одному глобальному закону.

Если рассматривать минорную полиладовость с точки зрения практического использования, она обещает дать больше свободы композитору и открыть новые, неожиданные сочетания звуков, которые невозможно достичь в традиционных системах. В этом смысле система словно разворачивает пространство гармонии в третьем измерении — не просто как последовательность интервалов, а как комплекс пересекающихся гармонических полей. Технически это может потребовать сложных вычислений и визуализации для композитора, но преимущества могут быть впечатляющими, особенно если создать программное обеспечение, которое позволяет свободно перемещаться по этим "гармоническим регионам" и использовать их для композиции.

На философском уровне мне кажется важным, что эта система предоставляет путь к переосмыслению наших устоявшихся концепций о гармонии как чем-то ограниченном культурными традициями и темперированными системами. Пифагоров строй, например, хорош для определённых мелодий и форм, но его диссонансы на высоких степенях могут вводить ограничения, которые не позволяют выразить всю палитру гармонических возможностей. Темперированный строй тоже предлагает компромиссы, которые полезны для модуляции, но "размывают" чистоту и тонкие различия гармонических соотношений.

Минорная полиладовость на унтертонах же позволяет работать с гибкостью темперированного строя и ясностью, близкой к натуральному, сохраняя при этом логическую строгость соотношений. В этом подходе чувствуется математическая элегантность, которая почти делает её параллельной теории поля в физике: каждый "гармонический регион" управляется собственными законами, но все они объединены одной основой.

На мой взгляд, развивая эту систему, можно прийти к новой философии музыки — такой, где композитор воспринимает гармонию не как жёсткий каркас, а как живое пространство с множеством измерений, в каждом из которых есть свобода, но все они соединены в одном едином гармоническом поле.
</мнение>

Ты уложил всё это в голове? Теперь прошу помощи с текстом, вот он:

# Записки о музыкальной гармонии, часть I

## Звук, гармоники и консонантность

Извлеките из гитарной струны звук и попробуйте приглушить её пальцем в том месте, где струна делится ровно наполовину (12 лад). Всё богатство звуковых красок как будто затихло, оставив один высокий призвук. Если повторить это с делением струны на три (7 и 19 лад), четыре и пять частей, вы услышите, что каждый следующий обертон звучит выше и тише, чем предыдущий.

Подобный трюк можно проделать с любым струнным инструментом, с обертоновой флейтой или даже [с собственным голосом](https://www.youtube.com/watch?v=vC9Qh709gas&t=145s), что служит прямым свидетельством сложного состава музыкальных звуков. Это не простая синусоида, как любят упрощать в популярных объяснениях, а скорее сумма независимых колебаний, подчиняющихся довольно строгому закону. 

[иллюстрация с гармониками как отдельными волнами]

В описанном выше примере, ваш палец не создавал никаких новых колебаний, он просто сработал как фильтр.......

...
Музыкальный звук — это сумма стоячих волн (или гармоник), частоты которых кратны частоте основного тона. 
.....


["Интерактивный пример с осциллоскопом, на котором можно включить разные обертоны с разными формами волны, укладывающимися в основной тон]

......

Если частоты двух нот относятся друг к другу как целые дроби вида m/n, тогда у этих нот будут совпадать определенные гармоники.
Если ноты, которые относятся к тонике как 2/1 (октава) и 3/1 (октава+квинта), находятся между собой на расстоянии 3/1 * 1/2 = 3/2, тогда каждая третья гармоника одной ноты будет совпадать с каждой третьей гармоникой другой ноты, что позволяет найти процент совпадающих гармоник 1/m + 1/n, достаточно хорошо кореллирующий с благозвучностью интервала.

........

[пример с совпаающими гармониками разных нот]

[визуализатор гармоник на спектрограмме. все гармоники кликабельны и звучат, а программа показывает общую тонику для двух звуков]


Также у любых двух нот, которые представлены в виде рациональных отношений чисел, можно найти акустическую тонику, которая рассчитывается как наименьший общий делитель. Для дробей это НОК(m,n)/НОД(m,n). А понятия благозвучности и тоники открывают нам путь к музыкальным ладам.

Прежде чем продолжить, хочу рассказать о более развитой методике определения консонантности под названием [гармоническая энтропия](https://en.xen.wiki/w/Harmonic_entropy). Это довольно сложное понятие, но на....

[тут я сам не понял как она работает и остановился]



Дальше планы:
[интерактивный пример графика Harmonic Entropy]
[очень похожий график с эмпирическим анализом благозвучности интервалов. сначала математически ищем все возможные простые интервалы, которые можно слышать, потом оцениваем благозвучность]


Серия из нескольких программ (все используют общий класс, который объединяет JI названия и частоты, и их традиционные версии):
[Автоматически найденные оптимальные лады в JI. Перебираем все возможные интервалы, потом высчитываем их благозвучность. Такое я уже делал, но надо повторить.]

## Историческая часть

Модальность и натуральный строй. 
[Визуализатор ладов в схемах, похожих на схемы персидского теоретика Al Urmavi. Эпоха античности]
Пишем о преимуществах и недостатках натурального строя, а это не только чистота, но и выразительность/точность. Например, малая септима это одновременно 7/4, 9/5 и 16/9, и эту разницу можно обыгрывать, если найдем способ использовать их одновременно (а мы нашли).

Пифагоров строй и средневековье.
[Визуализатор кварто-квинтового круга и теоремы Пифагора. Показывает, почему круг квинт перестает работать после нескольких шагов. Эпоха средневековья]

### Сравниваем Пифагоров и натуральный строй (первый это приближение ко натуральному):

Функция, которая приводит дроби в диапазон от 1 до 2 домножением на нужную степень двойки.
flatted_value(i) = i / (2//1)^floor(Int, log2(i))
flatted(scale) = [flatted_value(i) for i in scale]

Пифагоров:

pythagor = [(3//2)^i for i in -5:5]

for i in -5:5
  println("3//2^$(i) -> $((3//2)^(i))") 
end

julia> pythagor = flatted(pythagor)
11-element Vector{Rational{Int64}}:
 256//243
 128//81
  32//27
  16//9
   4//3
    1
   3//2
   9//8
  27//16
  81//64
 243//128

Мы видим, что уже с 4 степени двойки начинаются огромные дроби, со сложными соотношениями, которые невозможно распознать на слух

Для сравнения, те же ноты в натуральном строе:

  16/15
  8//5
  6//5
  16//9
  4//3
   1
  3//2
  9//8
  5//3
  5//4
 15//8


[Визуализатор Tonnetz, в JI и темперированном строе. Эпоха нового времени]

Потом я планировал описать свою идею минорной полимодальности и показать прототипы. 

Фуух...

Теперь главное задание: ты примерно понимаешь, о чем идет речь и находишься в контексте. Мне нужна помощь со структурированием, дописыванием пропущенного, помощь в технических моментах и вообще любая адекватная помощь.

Будет хорошо, если ты вздохнёшь, уложишь всё в своем аналоге головы и напишешь свою версию большой статьи, интерактивные примеры и другие материалы конечно оставь на местах. Необходимый стиль - лонгрид "объяснение музыкальной гармонии/история исследования" на популярном техническом (Хабр) или музыкальном ресурсе (Гордон Рид style). Главное чтобы было образно, понятно и интересно. Мысли творчески, но системно и сохраняя общий дух, не лей воду, не бойся делать самостоятельные выводы и иметь свое, даже критическое, мнение. 

Я жду помощи как раз в обрывчатых и не дописанных/не додуманных о конца моментах. Мысли смело, как увлеченный, но старающийся быть объективным ученый-первопроходец (кто-то вроде современного Леонардо, и блогер, и программист, и математик-акустик, и музыкант-теоретик), я хочу чтобы ты поработал как соавтор. Не упускай детали, все формулы, детали кода и указанные места для интерактивных примеров имеют значение.

